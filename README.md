Домашнее задание № 8. Закиров Андрей

Дисциплина: Программирование на Python

Тема: Взаимодействие в WWW: взаимодействие с сервисами

Цель задания:
Научиться использовать инструмент Scapy для анализа сетевого трафика и
эксплуатации уязвимостей cross-site scripting (XSS) на учебном сайте Google
Gruyere.

Инструменты для выполнения ДЗ:
Scapy, Google Gruyere, браузерные инструменты разработчика для анализа
веб-страниц.

Этап 1. Изучение Scapy 

•	Изучены основы работы с Scapy по документации (структура пакетов, перехват трафика, фильтрация по протоколам).

•	Настроено окружение для работы со скриптом scapy, временно отключены RST-пакеты командой:

sudo iptables -A OUTPUT -p tcp --tcp-flags RST RST -j DROP


Этап 2. Анализ трафика 
•	Проведено ознакомление с инструментом Google Gruyere и он запущен по адресу:
http://google-gruyere.appspot.com/408086229062912822940580099856782328160/
•	HTTP-ответы сервера сжаты (gzip), функция анализа в скрипте доработана для корректного отображения содержимого ответа.
Взаимодействуем с сайтом (переходы по страницам, отправка форм,
ввод данных), фиксируя трафик.
 Проанализируем перехваченные HTTP-запросы и ответы:
– метод запроса (GET / POST);
– URL и параметры;
– заголовки;
– тело запроса и ответа

Для запуска воспользуемся командой:

$ sudo python3 scapy_xss_analyzer.py --capture google-gruyere.appspot.com --timeout 20 --output traffic1.pcap

Пример ответа 1 сохранен в файле traffic1.pcap.

Этап 3. Эксплуатация XSS

Проведем рекон-анализ сайта Google Gruyere для поиска
потенциальных точек внедрения XSS:

Для добавления снипетов зарегистрирован пользователь. Попытка добавить <script>alert('XSS')</script> в поле снипета неудачна, возможно фильтр script.
XSS добавлена через ввод типа </img src="nonexistent.jpg" onerror="alert('XSS')">.

В итоге использован код 
</img src=x onerror="alert('test xss. Cookie: ' + document.cookie)"> 
для примера эксплуатации уязвимости. При переходе на сайт XSS срабатывает.

Этап 4. Анализ результатов
Используя скрипт, выполним анализ сохранённого .pcap-файла.
Для этого используем команду:

sudo python3 scapy_xss_analyzer.py --analyze traffic2.pcap

Добавим анализ на наличие XSS-полезных нагрузок.

Добавим поиск отраженных XSS в ответах сервера.